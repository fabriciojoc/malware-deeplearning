# -*- coding: UTF-8 -*-.
import argparse
import os
import csv

def params():
    parser = argparse.ArgumentParser()
    parser.add_argument('input_csv', help='Input CSV location')
    parser.add_argument('output_csv', help='Output CSV location')
    params = parser.parse_args()
    return params.input_csv, params.output_csv

# write header
def write_header(input_file, output_file):
    csv_out = open(output_file, "a")
    c = csv.writer(csv_out)
    with open(input_file, 'rb') as file:
        reader = csv.DictReader(file)
        for row in reader:
            header = row.keys()
            header.sort()
            c.writerow(header)
            return header

# remove md5 duplications
def remove_duplications(input_file, output_file, header):
    csv_out = open(output_file, "a")
    c = csv.writer(csv_out)
    with open(input_file, 'rb') as file:
        reader = csv.DictReader(file)
        md5 = []
        for row in reader:
            example = []
            if row['MD5'] not in md5:
                for f in header:
                    example.append(row[f])
                c.writerow(example)
                md5.append(row['MD5'])

# get params
input_csv, output_csv = params()
header = write_header(input_csv, output_csv)
remove_duplications(input_csv, output_csv, header)
