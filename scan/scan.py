# -*- coding: UTF-8 -*-.
import requests
import argparse
import csv
import numpy as np

API_KEY=""

def params():
    parser = argparse.ArgumentParser()
    parser.add_argument('csv_location', help='CSV location')
    params = parser.parse_args()
    return params.csv_location

USED_FEATURES = [ "MD5"]

def read_file(input_file):
    with open(input_file, 'rb') as file:
        reader = csv.DictReader(file)
        features = []
        identifiers = []
        imported_dlls = []
        imported_symbols = []
        for row in reader:
            example = row['MD5']
            # example.append()
            # append current example features
            features.append(example)
    features = np.array(features)
    return features


location = params()
malwares = read_file(location);

for m in malwares:
    print m
    params = {'apikey': API_KEY, 'resource': m}
    response = requests.get('https://www.virustotal.com/vtapi/v2/file/report', params=params)
    json_response = response.json()
    print json_response['scans']['Avast']['result']
