# -*- coding: UTF-8 -*-.
import argparse
import os
import csv

API_KEY=""

def params():
    parser = argparse.ArgumentParser()
    parser.add_argument('files_location', help='Files location')
    params = parser.parse_args()
    return params.files_location

def send_file(location):
    for root, dirs, files in os.walk(location):
        for f in sorted(files):
            try:
                print f
                file_loc = os.path.join(root, f)
                params = {'apikey': API_KEY}
                files = {'file': (f, open(file_loc, 'rb'))}
                response = requests.post('https://www.virustotal.com/vtapi/v2/file/scan', files=files, params=params)
                json_response = response.json()
                print json_response
            except:
                print "Invalid file."
                pass

# get files location
files_location = params()
# send file to virus total
send_file(files_location)
